# ì›Œí¬í”Œë¡œìš°ì˜ ì´ë¦„
name: Deploy blog to GitHub Pages

# ì–¸ì œ ì´ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰í• ì§€ ê²°ì •
on:
  push:
    branches:
      - blog  # 'blog' ë¸Œëœì¹˜ì— push ë  ë•Œë§Œ ì‹¤í–‰

# ì›Œí¬í”Œë¡œìš°ì— í•„ìš”í•œ ê¶Œí•œ ì„¤ì •
permissions:
  contents: write

# ì‹¤ì œ ì‘ì—…(Job) ì •ì˜
jobs:
  build-and-deploy:
    # ì‘ì—… ì´ë¦„
    name: Build and Deploy blog
    # ì‘ì—…ì´ ì‹¤í–‰ë  ê°€ìƒ í™˜ê²½
    runs-on: ubuntu-latest

    # ì‘ì—… ë‹¨ê³„(Step)ë“¤
    steps:
      # 1. ì†ŒìŠ¤ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v4

      # 2. Node.js í™˜ê²½ ì„¤ì • (React ë¹Œë“œë¥¼ ìœ„í•´ í•„ìš”)
      - name: Setup Node.js ğŸŸ©
        uses: actions/setup-node@v4
        with:
          node-version: '20'   # Node.js ë²„ì „
          cache: 'npm'         # npm ìºì‹±ìœ¼ë¡œ ì†ë„ í–¥ìƒ

      # 3. ì˜ì¡´ì„± íŒ¨í‚¤ì§€ ì„¤ì¹˜
      - name: Install dependencies ğŸ“¦
        run: npm ci

      # 4. í”„ë¡œì íŠ¸ ë¹Œë“œ (vite.config.jsì˜ base ì„¤ì •ì´ ì—¬ê¸°ì„œ ì‚¬ìš©ë¨)
      - name: Build project ğŸ—ï¸
        # vite.config.jsì— base: '/[ì €ì¥ì†Œì´ë¦„]/[ë¸Œëœì¹˜ì´ë¦„]/' ì„¤ì •ì´ ë˜ì–´ ìˆì–´ì•¼ í•¨
        run: npm run build

      # 5. ë¹Œë“œ ê²°ê³¼ë¬¼ì„ gh-pages ë¸Œëœì¹˜ì— ë°°í¬
      - name: Deploy to gh-pages ğŸš€
        uses: peaceiris/actions-gh-pages@v4
        with:
          # ë°°í¬ë¥¼ ìœ„í•œ ì¸ì¦ í† í°
          github_token: ${{ secrets.GITHUB_TOKEN }}
          # ë°°í¬í•  ë¸Œëœì¹˜
          publish_branch: gh-pages
          # ë°°í¬í•  í´ë” (ë¹Œë“œ ê²°ê³¼ë¬¼)
          publish_dir: ./dist
          # ë°°í¬ë  ëª©ì ì§€ í•˜ìœ„ í´ë”
          destination_dir: ./blog
          # ë‹¤ë¥¸ í”„ë¡œì íŠ¸ íŒŒì¼ì„ ì‚­ì œí•˜ì§€ ì•Šê³  ìœ ì§€
          keep_files: true